---
import type { GetStaticPaths, InferGetStaticParamsType, InferGetStaticPropsType } from 'astro';
import Layout from '../layouts/Layout.astro';

interface Frontmatter {
  title?: string;
  description?: string;
}

export const getStaticPaths = (async () => {
  const peptideModules = import.meta.glob<Frontmatter>('../content/peptides/*.md', { eager: true });

  const peptideFiles = Object.entries(peptideModules).map(([path, file]) => {
    const slug = path.split('/').pop()?.replace('.md', '') || '';
    return {
      params: { peptide: slug },
      props: { file }
    };
  });

  return peptideFiles;
}) satisfies GetStaticPaths;

type Params = InferGetStaticParamsType<typeof getStaticPaths>;
type Props = InferGetStaticPropsType<typeof getStaticPaths>;

const { file } = Astro.props as Props;
const { default: Content, frontmatter } = file as { default: any; frontmatter: Frontmatter };
---

<Layout title={frontmatter.title || 'Peptide'}>
  <div class="min-h-screen flex flex-col">
    <main class="flex-1 container mx-auto px-4 py-8 max-w-4xl">
      <a href="/" class="link link-primary mb-4 inline-block">‚Üê Back to Peptides</a>
      <article class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <h1 class="text-4xl md:text-5xl font-bold text-primary mb-4">{frontmatter.title}</h1>
          {
            frontmatter.description && (
              <div class="alert alert-info mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span class="text-lg">{frontmatter.description}</span>
              </div>
            )
          }
          <div class="divider"></div>
          <div class="prose prose-lg max-w-none text-base-content">
            <Content />
          </div>
        </div>
      </article>
    </main>
  </div>
</Layout>
